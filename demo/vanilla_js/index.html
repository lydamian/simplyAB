<!DOCTYPE html>
<html>
<head>
  <title>Demo simply_ab_framework</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
  <h1>Random number game</h1>
  <button id="show-number-button">Get a number between 1 - 100</button>
</body>

<script>
  const singleton_config = {
    project_id: 1,
    simply_ab_api_auth_token: 'd549e7487d128c445c743172c1ea2f5ab0d217ab53cdff9e599d1366d2c830a7',
  };

  const get_user_variant = async (user_id, experiment_key) => {
    const button_experiment_variant_url = `http://localhost:5000/api/v1/user/${user_id}/project/${singleton_config.project_id}/experiment/${experiment_key}/variant-info`;
    const response = await fetch(button_experiment_variant_url, {
      method: 'GET',
      headers: {
        Authorization: singleton_config.simply_ab_api_auth_token,
      }
    });
    const response_json = response.json();
    return response_json;
  }

  document.addEventListener("DOMContentLoaded", async function(){
    //dom is fully loaded, but maybe waiting on images & css files
    // lets load the api framework
    const user_id = 1;
    const experiment_key="landing_page_button_experiment";
    const show_number_elem = document.getElementById('show-number');
    const user_button_experiment_variant = await get_user_variant(user_id, experiment_key);
    if (user_button_experiment_variant.variant_key === "treatment") {
      document.getElementById("show-number-button").classList.add("bg-red-50");
    } else {
      document.getElementById("show-number-button").classList.add("bg-blue-50");
    }
    console.log('user_button_experiment_variant', JSON.stringify(user_button_experiment_variant, null, 2))
  });

</script>
</html>
